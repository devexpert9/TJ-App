/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
var NgxStarsComponent = /** @class */ (function () {
    function NgxStarsComponent() {
        this.maxStars = 5;
        this.initialStars = 0;
        this.animationSpeed = 100;
        this.wholeStars = false;
        this.ratingOutput = new EventEmitter();
    }
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        this.editableStars = Array.from(new Array(this.maxStars)).map(function (elem, index) { return new EditableStar(index); });
        this.setRating(this.initialStars);
        if (this.animation) {
            this.animationInterval = setInterval(this.starAnimation.bind(this), this.animationSpeed);
        }
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.starColorAndPadding = /**
     * @return {?}
     */
    function () {
        return Object.assign({}, this.starColor(), this.starPadding());
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.starColor = /**
     * @return {?}
     */
    function () {
        return { color: this.color || 'crimson' };
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.starPadding = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var padding = '0.5rem';
        if (Number.isInteger(this.size) || this.size > 0 || this.size < 6) {
            padding = "0." + this.size + "rem";
        }
        return { 'margin-right': this.customPadding || padding };
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.starSize = /**
     * @return {?}
     */
    function () {
        if (!Number.isInteger(this.size) || this.size < 2 || this.size > 5) {
            return '';
        }
        return "fa-" + this.size + "x";
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.starAnimation = /**
     * @return {?}
     */
    function () {
        this.animationRunning = true;
        if (this.rating < this.maxStars) {
            this.setRating(this.rating += 0.5);
        }
        else {
            this.setRating(0);
        }
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.cancelStarAnimation = /**
     * @return {?}
     */
    function () {
        if (this.animationRunning) {
            clearInterval(this.animationInterval);
            this.rating = 0;
            this.animationRunning = false;
        }
    };
    /**
     * @param {?} rating
     * @return {?}
     */
    NgxStarsComponent.prototype.setRating = /**
     * @param {?} rating
     * @return {?}
     */
    function (rating) {
        this.rating = Math.round(rating * 2) / 2;
        this.onStarsUnhover();
    };
    /**
     * @param {?} event
     * @param {?} clickedStar
     * @return {?}
     */
    NgxStarsComponent.prototype.onStarHover = /**
     * @param {?} event
     * @param {?} clickedStar
     * @return {?}
     */
    function (event, clickedStar) {
        this.cancelStarAnimation();
        /** @type {?} */
        var clickedInFirstHalf = this.clickedInFirstHalf(event);
        // fill in either a half or whole star depending on where user clicked
        clickedStar.classname = (!this.wholeStars && clickedInFirstHalf) ? 'fa-star-half-o' : 'fa-star';
        // fill in all stars in previous positions and clear all in later ones
        this.editableStars.forEach(function (star) {
            if (star.position > clickedStar.position) {
                star.classname = 'fa-star-o';
            }
            else if (star.position < clickedStar.position) {
                star.classname = 'fa-star';
            }
        });
    };
    /**
     * @param {?} event
     * @param {?} clickedStar
     * @return {?}
     */
    NgxStarsComponent.prototype.onStarClick = /**
     * @param {?} event
     * @param {?} clickedStar
     * @return {?}
     */
    function (event, clickedStar) {
        this.cancelStarAnimation();
        /** @type {?} */
        var clickedInFirstHalf = this.clickedInFirstHalf(event);
        this.rating = clickedStar.position + ((!this.wholeStars && clickedInFirstHalf) ? 0.5 : 1);
        this.ratingOutput.emit(this.rating);
    };
    // hidden star to left of first star lets user click there to set to 0
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.onZeroStarClick = /**
     * @return {?}
     */
    function () {
        this.setRating(0);
        this.ratingOutput.emit(this.rating);
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.onZeroStarHover = /**
     * @return {?}
     */
    function () {
        // clear all stars
        this.editableStars.forEach(function (star) { return star.classname = 'fa-star-o'; });
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.onStarsUnhover = /**
     * @return {?}
     */
    function () {
        var _this = this;
        // when user stops hovering we want to make stars reflect the last rating applied by clicking
        this.editableStars.forEach(function (star) {
            /** @type {?} */
            var starNumber = star.position + 1;
            if (_this.rating >= starNumber) {
                star.classname = 'fa-star';
            }
            else if (_this.rating > starNumber - 1 && _this.rating < starNumber) {
                star.classname = 'fa-star-half-o';
            }
            else {
                star.classname = 'fa-star-o';
            }
        });
    };
    /**
     * @param {?} event
     * @return {?}
     */
    NgxStarsComponent.prototype.clickedInFirstHalf = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var starIcon = /** @type {?} */ (event.target);
        return event.pageX < starIcon.getBoundingClientRect().left + starIcon.offsetWidth / 2;
    };
    /**
     * @return {?}
     */
    NgxStarsComponent.prototype.noop = /**
     * @return {?}
     */
    function () { };
    NgxStarsComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-stars',
                    template: "<link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css\">\n\n<div class=\"stars-line\" (mouseleave)=\"readonly ? noop() : onStarsUnhover()\">\n  <i [ngClass]=\"['fa fa-star ' + starSize()]\" class=\"zero-star\" aria-hidden=\"true\" (click)=\"onZeroStarClick()\" (mousemove)=\"readonly ? noop() : onZeroStarHover()\"></i>\n  <div *ngFor=\"let star of editableStars;\" (click)=\"readonly ? noop() : onStarClick($event, star)\" (mousemove)=\"readonly ? noop() : onStarHover($event, star)\">\n    <i [ngClass]=\"['fa ' + starSize(), star.classname]\" [ngStyle]=\"starColorAndPadding()\" aria-hidden=\"true\"></i>\n  </div>\n</div>\n",
                    styles: ["i:not(.zero-star){color:#b42025}.stars-line{display:flex;align-items:center;position:relative}.stars-line>div{z-index:999}.zero-star{color:transparent;position:absolute;left:-16px}"],
                },] },
    ];
    NgxStarsComponent.propDecorators = {
        maxStars: [{ type: Input }],
        initialStars: [{ type: Input }],
        readonly: [{ type: Input }],
        size: [{ type: Input }],
        color: [{ type: Input }],
        animation: [{ type: Input }],
        animationSpeed: [{ type: Input }],
        customPadding: [{ type: Input }],
        wholeStars: [{ type: Input }],
        ratingOutput: [{ type: Output }]
    };
    return NgxStarsComponent;
}());
export { NgxStarsComponent };
if (false) {
    /** @type {?} */
    NgxStarsComponent.prototype.maxStars;
    /** @type {?} */
    NgxStarsComponent.prototype.initialStars;
    /** @type {?} */
    NgxStarsComponent.prototype.readonly;
    /** @type {?} */
    NgxStarsComponent.prototype.size;
    /** @type {?} */
    NgxStarsComponent.prototype.color;
    /** @type {?} */
    NgxStarsComponent.prototype.animation;
    /** @type {?} */
    NgxStarsComponent.prototype.animationSpeed;
    /** @type {?} */
    NgxStarsComponent.prototype.customPadding;
    /** @type {?} */
    NgxStarsComponent.prototype.wholeStars;
    /** @type {?} */
    NgxStarsComponent.prototype.ratingOutput;
    /** @type {?} */
    NgxStarsComponent.prototype.rating;
    /** @type {?} */
    NgxStarsComponent.prototype.editableStars;
    /** @type {?} */
    NgxStarsComponent.prototype.animationInterval;
    /** @type {?} */
    NgxStarsComponent.prototype.animationRunning;
}
var EditableStar = /** @class */ (function () {
    function EditableStar(position) {
        this.position = position;
        this.classname = 'fa-star-o';
    }
    return EditableStar;
}());
export { EditableStar };
if (false) {
    /** @type {?} */
    EditableStar.prototype.position;
    /** @type {?} */
    EditableStar.prototype.classname;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXN0YXJzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL25neC1zdGFycy8iLCJzb3VyY2VzIjpbImxpYi9uZ3gtc3RhcnMuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLFlBQVksRUFBRSxLQUFLLEVBQVUsTUFBTSxFQUFFLE1BQU0sZUFBZSxDQUFDOzs7UUFpQjdFLGdCQUNtQixDQUFDLENBQUM7UUFFckIsb0JBQ3VCLENBQUMsQ0FBQztRQWN6QixzQkFDeUIsR0FBRyxDQUFDO1FBSzdCLGtCQUNzQixLQUFLLENBQUM7UUFFNUIsb0JBQ3FDLElBQUksWUFBWSxFQUFFLENBQUM7Ozs7O0lBT3hELG9DQUFROzs7SUFBUjtRQUNFLElBQUksQ0FBQyxhQUFhLEdBQUcsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsVUFBQyxJQUFJLEVBQUUsS0FBSyxJQUFLLE9BQUEsSUFBSSxZQUFZLENBQUMsS0FBSyxDQUFDLEVBQXZCLENBQXVCLENBQUMsQ0FBQztRQUN4RyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUVsQyxJQUFJLElBQUksQ0FBQyxTQUFTLEVBQUU7WUFDbEIsSUFBSSxDQUFDLGlCQUFpQixHQUFHLFdBQVcsQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDMUY7S0FDRjs7OztJQUVELCtDQUFtQjs7O0lBQW5CO1FBQ0UsT0FBTyxNQUFNLENBQUMsTUFBTSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsU0FBUyxFQUFFLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDLENBQUM7S0FDaEU7Ozs7SUFFTyxxQ0FBUzs7OztRQUNmLE9BQU8sRUFBRSxL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QUFLLENBQUMsTUFBcUIsRUFBQztRQUM3QyxPQUFPLEtBQUssQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDLHFCQUFxQixFQUFFLENBQUMsSUFBSSxHQUFHLFFBQVEsQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDOzs7OztJQUd4RixnQ0FBSTs7O0lBQUosZUFBZTs7Z0JBdEtoQixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLFdBQVc7b0JBQ3JCLFFBQVEsRUFBRSw4cUJBUVg7b0JBQ0MsTUFBTSxFQUFFLENBQUMsc0xBQXNMLENBQUM7aUJBQ2pNOzs7MkJBR0UsS0FBSzsrQkFHTCxLQUFLOzJCQUdMLEtBQUs7dUJBR0wsS0FBSzt3QkFHTCxLQUFLOzRCQUdMLEtBQUs7aUNBR0wsS0FBSztnQ0FHTCxLQUFLOzZCQUdMLEtBQUs7K0JBR0wsTUFBTTs7NEJBNUNUOztTQWVhLGlCQUFpQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQTRKOUIsSUFBQTtJQUlFLHNCQUFZLFFBQWdCO1FBQzFCLElBQUksQ0FBQyxRQUFRLEdBQUcsUUFBUSxDQUFDO1FBQ3pCLElBQUksQ0FBQyxTQUFTLEdBQUcsV0FBVyxDQUFDO0tBQzlCO3VCQWxMSDtJQW1MQyxDQUFBO0FBUkQsd0JBUUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25neC1zdGFycycsXG4gIHRlbXBsYXRlOiBgPGxpbmsgcmVsPVwic3R5bGVzaGVldFwiIGhyZWY9XCJodHRwczovL3N0YWNrcGF0aC5ib290c3RyYXBjZG4uY29tL2ZvbnQtYXdlc29tZS80LjcuMC9jc3MvZm9udC1hd2Vzb21lLm1pbi5jc3NcIj5cblxuPGRpdiBjbGFzcz1cInN0YXJzLWxpbmVcIiAobW91c2VsZWF2ZSk9XCJyZWFkb25seSA/IG5vb3AoKSA6IG9uU3RhcnNVbmhvdmVyKClcIj5cbiAgPGkgW25nQ2xhc3NdPVwiWydmYSBmYS1zdGFyICcgKyBzdGFyU2l6ZSgpXVwiIGNsYXNzPVwiemVyby1zdGFyXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCIgKGNsaWNrKT1cIm9uWmVyb1N0YXJDbGljaygpXCIgKG1vdXNlbW92ZSk9XCJyZWFkb25seSA/IG5vb3AoKSA6IG9uWmVyb1N0YXJIb3ZlcigpXCI+PC9pPlxuICA8ZGl2ICpuZ0Zvcj1cImxldCBzdGFyIG9mIGVkaXRhYmxlU3RhcnM7XCIgKGNsaWNrKT1cInJlYWRvbmx5ID8gbm9vcCgpIDogb25TdGFyQ2xpY2soJGV2ZW50LCBzdGFyKVwiIChtb3VzZW1vdmUpPVwicmVhZG9ubHkgPyBub29wKCkgOiBvblN0YXJIb3ZlcigkZXZlbnQsIHN0YXIpXCI+XG4gICAgPGkgW25nQ2xhc3NdPVwiWydmYSAnICsgc3RhclNpemUoKSwgc3Rhci5jbGFzc25hbWVdXCIgW25nU3R5bGVdPVwic3RhckNvbG9yQW5kUGFkZGluZygpXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICA8L2Rpdj5cbjwvZGl2PlxuYCxcbiAgc3R5bGVzOiBbYGk6bm90KC56ZXJvLXN0YXIpe2NvbG9yOiNiNDIwMjV9LnN0YXJzLWxpbmV7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtwb3NpdGlvbjpyZWxhdGl2ZX0uc3RhcnMtbGluZT5kaXZ7ei1pbmRleDo5OTl9Lnplcm8tc3Rhcntjb2xvcjp0cmFuc3BhcmVudDtwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi0xNnB4fWBdLFxufSlcbmV4cG9ydCBjbGFzcyBOZ3hTdGFyc0NvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG5cbiAgQElucHV0KClcbiAgbWF4U3RhcnM6IG51bWJlciA9IDU7XG5cbiAgQElucHV0KClcbiAgaW5pdGlhbFN0YXJzOiBudW1iZXIgPSAwO1xuXG4gIEBJbnB1dCgpXG4gIHJlYWRvbmx5OiBib29sZWFuO1xuXG4gIEBJbnB1dCgpXG4gIHNpemU6IG51bWJlcjtcblxuICBASW5wdXQoKVxuICBjb2xvcjogc3RyaW5nO1xuXG4gIEBJbnB1dCgpXG4gIGFuaW1hdGlvbjogYm9vbGVhbjtcblxuICBASW5wdXQoKVxuICBhbmltYXRpb25TcGVlZDogbnVtYmVyID0gMTAwO1xuXG4gIEBJbnB1dCgpXG4gIGN1c3RvbVBhZGRpbmc6IHN0cmluZztcblxuICBASW5wdXQoKVxuICB3aG9sZVN0YXJzOiBib29sZWFuID0gZmFsc2U7XG5cbiAgQE91dHB1dCgpXG4gIHJhdGluZ091dHB1dDogRXZlbnRFbWl0dGVyPG51bWJlcj4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG5cbiAgcmF0aW5nOiBudW1iZXI7XG4gIGVkaXRhYmxlU3RhcnM6IEVkaXRhYmxlU3RhcltdO1xuICBhbmltYXRpb25JbnRlcnZhbDogYW55O1xuICBhbmltYXRpb25SdW5uaW5nOiBib29sZWFuO1xuXG4gIG5nT25Jbml0KCk6IHZvaWQge1xuICAgIHRoaXMuZWRpdGFibGVTdGFycyA9IEFycmF5LmZyb20obmV3IEFycmF5KHRoaXMubWF4U3RhcnMpKS5tYXAoKGVsZW0sIGluZGV4KSA9PiBuZXcgRWRpdGFibGVTdGFyKGluZGV4KSk7XG4gICAgdGhpcy5zZXRSYXRpbmcodGhpcy5pbml0aWFsU3RhcnMpO1xuXG4gICAgaWYgKHRoaXMuYW5pbWF0aW9uKSB7XG4gICAgICB0aGlzLmFuaW1hdGlvbkludGVydmFsID0gc2V0SW50ZXJ2YWwodGhpcy5zdGFyQW5pbWF0aW9uLmJpbmQodGhpcyksIHRoaXMuYW5pbWF0aW9uU3BlZWQpO1xuICAgIH1cbiAgfVxuXG4gIHN0YXJDb2xvckFuZFBhZGRpbmcoKTogT2JqZWN0IHtcbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zdGFyQ29sb3IoKSwgdGhpcy5zdGFyUGFkZGluZygpKTtcbiAgfVxuXG4gIHByaXZhdGUgc3RhckNvbG9yKCk6IE9iamVjdCB7XG4gICAgcmV0dXJuIHsgY29sb3I6IHRoaXMuY29sb3IgfHwgJ2NyaW1zb24nIH07XG4gIH1cblxuICBwcml2YXRlIHN0YXJQYWRkaW5nKCk6IE9iamVjdCB7XG4gICAgbGV0IHBhZGRpbmcgPSAnMC41cmVtJztcbiAgICBpZiAoTnVtYmVyLmlzSW50ZWdlcih0aGlzLnNpemUpIHx8IHRoaXMuc2l6ZSA+IDAgfHwgdGhpcy5zaXplIDwgNikge1xuICAgICAgcGFkZGluZyA9IGAwLiR7dGhpcy5zaXplfXJlbWA7XG4gICAgfVxuXG4gICAgcmV0dXJuIHsgJ21hcmdpbi1yaWdodCc6IHRoaXMuY3VzdG9tUGFkZGluZyB8fCBwYWRkaW5nIH07XG4gIH1cblxuICBzdGFyU2l6ZSgpOiBzdHJpbmcge1xuICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcih0aGlzLnNpemUpIHx8IHRoaXMuc2l6ZSA8IDIgfHwgdGhpcy5zaXplID4gNSkge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgICByZXR1cm4gYGZhLSR7dGhpcy5zaXplfXhgO1xuICB9XG5cbiAgc3RhckFuaW1hdGlvbigpOiB2b2lkIHtcbiAgICB0aGlzLmFuaW1hdGlvblJ1bm5pbmcgPSB0cnVlO1xuICAgIGlmICh0aGlzLnJhdGluZyA8IHRoaXMubWF4U3RhcnMpIHtcbiAgICAgIHRoaXMuc2V0UmF0aW5nKHRoaXMucmF0aW5nICs9IDAuNSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGhpcy5zZXRSYXRpbmcoMCk7XG4gICAgfVxuICB9XG5cbiAgY2FuY2VsU3RhckFuaW1hdGlvbigpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5hbmltYXRpb25SdW5uaW5nKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuYW5pbWF0aW9uSW50ZXJ2YWwpO1xuICAgICAgdGhpcy5yYXRpbmcgPSAwO1xuICAgICAgdGhpcy5hbmltYXRpb25SdW5uaW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgc2V0UmF0aW5nKHJhdGluZzogbnVtYmVyKSB7XG4gICAgdGhpcy5yYXRpbmcgPSBNYXRoLnJvdW5kKHJhdGluZyAqIDIpIC8gMjtcbiAgICB0aGlzLm9uU3RhcnNVbmhvdmVyKCk7XG4gIH1cblxuICBvblN0YXJIb3ZlcihldmVudDogTW91c2VFdmVudCwgY2xpY2tlZFN0YXI6IEVkaXRhYmxlU3Rhcik6IHZvaWQge1xuICAgIHRoaXMuY2FuY2VsU3RhckFuaW1hdGlvbigpO1xuXG4gICAgY29uc3QgY2xpY2tlZEluRmlyc3RIYWxmID0gdGhpcy5jbGlja2VkSW5GaXJzdEhhbGYoZXZlbnQpO1xuXG4gICAgLy8gZmlsbCBpbiBlaXRoZXIgYSBoYWxmIG9yIHdob2xlIHN0YXIgZGVwZW5kaW5nIG9uIHdoZXJlIHVzZXIgY2xpY2tlZFxuICAgIGNsaWNrZWRTdGFyLmNsYXNzbmFtZSA9ICghdGhpcy53aG9sZVN0YXJzICYmIGNsaWNrZWRJbkZpcnN0SGFsZikgPyAnZmEtc3Rhci1oYWxmLW8nIDogJ2ZhLXN0YXInO1xuXG4gICAgLy8gZmlsbCBpbiBhbGwgc3RhcnMgaW4gcHJldmlvdXMgcG9zaXRpb25zIGFuZCBjbGVhciBhbGwgaW4gbGF0ZXIgb25lc1xuICAgIHRoaXMuZWRpdGFibGVTdGFycy5mb3JFYWNoKHN0YXIgPT4ge1xuICAgICAgaWYgKHN0YXIucG9zaXRpb24gPiBjbGlja2VkU3Rhci5wb3NpdGlvbikge1xuICAgICAgICBzdGFyLmNsYXNzbmFtZSA9ICdmYS1zdGFyLW8nO1xuICAgICAgfVxuICAgICAgZWxzZSBpZiAoc3Rhci5wb3NpdGlvbiA8IGNsaWNrZWRTdGFyLnBvc2l0aW9uKSB7XG4gICAgICAgIHN0YXIuY2xhc3NuYW1lID0gJ2ZhLXN0YXInO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgb25TdGFyQ2xpY2soZXZlbnQ6IE1vdXNlRXZlbnQsIGNsaWNrZWRTdGFyOiBFZGl0YWJsZVN0YXIpOiB2b2lkIHtcbiAgICB0aGlzLmNhbmNlbFN0YXJBbmltYXRpb24oKTtcblxuICAgIC8vIGxvY2sgaW4gY3VycmVudCByYXRpbmdcbiAgICBjb25zdCBjbGlja2VkSW5GaXJzdEhhbGYgPSB0aGlzLmNsaWNrZWRJbkZpcnN0SGFsZihldmVudCk7XG4gICAgdGhpcy5yYXRpbmcgPSBjbGlja2VkU3Rhci5wb3NpdGlvbiArICgoIXRoaXMud2hvbGVTdGFycyAmJiBjbGlja2VkSW5GaXJzdEhhbGYpID8gMC41IDogMSk7XG4gICAgdGhpcy5yYXRpbmdPdXRwdXQuZW1pdCh0aGlzLnJhdGluZyk7XG4gIH1cblxuICAvLyBoaWRkZW4gc3RhciB0byBsZWZ0IG9mIGZpcnN0IHN0YXIgbGV0cyB1c2VyIGNsaWNrIHRoZXJlIHRvIHNldCB0byAwXG4gIG9uWmVyb1N0YXJDbGljaygpOiB2b2lkIHtcbiAgICB0aGlzLnNldFJhdGluZygwKTtcbiAgICB0aGlzLnJhdGluZ091dHB1dC5lbWl0KHRoaXMucmF0aW5nKTtcbiAgfVxuXG4gIG9uWmVyb1N0YXJIb3ZlcigpOiB2b2lkIHtcbiAgICAvLyBjbGVhciBhbGwgc3RhcnNcbiAgICB0aGlzLmVkaXRhYmxlU3RhcnMuZm9yRWFjaChzdGFyID0+IHN0YXIuY2xhc3NuYW1lID0gJ2ZhLXN0YXItbycpO1xuICB9XG5cbiAgb25TdGFyc1VuaG92ZXIoKSB7XG4gICAgLy8gd2hlbiB1c2VyIHN0b3BzIGhvdmVyaW5nIHdlIHdhbnQgdG8gbWFrZSBzdGFycyByZWZsZWN0IHRoZSBsYXN0IHJhdGluZyBhcHBsaWVkIGJ5IGNsaWNraW5nXG4gICAgdGhpcy5lZGl0YWJsZVN0YXJzLmZvckVhY2goc3RhciA9PiB7XG4gICAgICBjb25zdCBzdGFyTnVtYmVyID0gc3Rhci5wb3NpdGlvbiArIDE7XG4gICAgICBpZiAodGhpcy5yYXRpbmcgPj0gc3Rhck51bWJlcikge1xuICAgICAgICBzdGFyLmNsYXNzbmFtZSA9ICdmYS1zdGFyJztcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKHRoaXMucmF0aW5nID4gc3Rhck51bWJlciAtIDEgJiYgdGhpcy5yYXRpbmcgPCBzdGFyTnVtYmVyKSB7XG4gICAgICAgIHN0YXIuY2xhc3NuYW1lID0gJ2ZhLXN0YXItaGFsZi1vJztcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBzdGFyLmNsYXNzbmFtZSA9ICdmYS1zdGFyLW8nO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBjbGlja2VkSW5GaXJzdEhhbGYoZXZlbnQ6IE1vdXNlRXZlbnQpOiBib29sZWFuIHtcbiAgICBjb25zdCBzdGFySWNvbiA9IGV2ZW50LnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICByZXR1cm4gZXZlbnQucGFnZVggPCBzdGFySWNvbi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsgc3Rhckljb24ub2Zmc2V0V2lkdGggLyAyO1xuICB9XG5cbiAgbm9vcCgpOiB2b2lkIHt9XG59XG5cbmV4cG9ydCBjbGFzcyBFZGl0YWJsZVN0YXIge1xuICBwb3NpdGlvbjogbnVtYmVyO1xuICBjbGFzc25hbWU6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwb3NpdGlvbjogbnVtYmVyKSB7XG4gICAgdGhpcy5wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgIHRoaXMuY2xhc3NuYW1lID0gJ2ZhLXN0YXItbyc7XG4gIH1cbn1cbiJdfQ==